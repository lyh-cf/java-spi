# java-spi
## SPI简介
SPI（Service Provider Interface），是JDK内置的一种**服务注册与发现机制**，可以用来启用框架扩展和替换组件，主要是被框架的开发人员使用，比如java.sql.Driver接口，其他不同厂商可以针对同一接口做出不同的实现，MySQL和PostgreSQL都有不同的实现提供给用户，而Java的SPI机制可以为某个接口寻找服务实现。Java中SPI机制主要思想是将装配的控制权移到程序之外，在模块化设计中这个机制尤其重要，其核心思想就是**解耦**。  
本项目是利用java的spi机制实现的一个小案例：用户（服务调用者）使用空调遥控器（定义接口）尝试打开空调（服务提供者，需要实现空调遥控器的接口）

## 核心思想
 * 面向接口编程，不直接使用实现类，为某个接口寻找服务的机制，类似IOC思想，将装配的控制权交给ServiceLoader。
 * 只提供服务接口，具体服务由其他组件实现，接口和具体实现分离（类似桥接），同时能够通过系统的ServiceLoader拿到这些实现类的集合，统一处理，这样在组件化中往往会带来很多便利，SPI机制可以实现不同模块之间方便的面向接口编程，拒绝了硬编码的方式，解耦效果很好。

## 注意事项
**服务提供者：**  
 * 需要实现服务调用者发布的接口  
 * 在META-INF/services目录下，创建一个接口全限定名的文件，内容是接口的实现类的全限定名  
 * 实现类必须要有一个无参构造器，因为服务调用者是通过ServiceLoader.load来动态加载发现服务的，其迭代底层是用S p = service.cast(c.newInstance());来创建实例的

## 核心代码
![image](https://github.com/lyh-cf/java-spi/assets/107308317/d54f067a-f715-4fcd-8970-8bf70b408082)
